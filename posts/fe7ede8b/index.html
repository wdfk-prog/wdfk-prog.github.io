<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>构建 | wdfk-prog的个人博客</title><meta name="author" content="Liya Huang"><meta name="copyright" content="Liya Huang"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="[toc] art-pi构建命令123456789101112131415export CROSS_COMPILE&#x3D;arm-none-eabi- ARCH&#x3D;armmake stm32h750-art-pi_defconfigmake menuconfig    &gt; Boot options        (console&#x3D;ttySTM0,115200 root&#x3D;&#x2F;dev&#x2F;ram loglev">
<meta property="og:type" content="article">
<meta property="og:title" content="构建">
<meta property="og:url" content="https://wdfk-prog.space/posts/fe7ede8b/index.html">
<meta property="og:site_name" content="wdfk-prog的个人博客">
<meta property="og:description" content="[toc] art-pi构建命令123456789101112131415export CROSS_COMPILE&#x3D;arm-none-eabi- ARCH&#x3D;armmake stm32h750-art-pi_defconfigmake menuconfig    &gt; Boot options        (console&#x3D;ttySTM0,115200 root&#x3D;&#x2F;dev&#x2F;ram loglev">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://wdfk-prog.space/images/covers/02.jpg">
<meta property="article:published_time" content="2025-10-03T01:44:27.000Z">
<meta property="article:modified_time" content="2025-10-03T09:23:27.828Z">
<meta property="article:author" content="Liya Huang">
<meta property="article:tag" content="uboot">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://wdfk-prog.space/images/covers/02.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "构建",
  "url": "https://wdfk-prog.space/posts/fe7ede8b/",
  "image": "https://wdfk-prog.space/images/covers/02.jpg",
  "datePublished": "2025-10-03T01:44:27.000Z",
  "dateModified": "2025-10-03T09:23:27.828Z",
  "author": [
    {
      "@type": "Person",
      "name": "Liya Huang",
      "url": "https://github.com/wdfk-prog"
    }
  ]
}</script><link rel="shortcut icon" href="/images/favicon.png"><link rel="canonical" href="https://wdfk-prog.space/posts/fe7ede8b/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//static.cloudflareinsights.com"/><link rel="preconnect" href="//www.clarity.ms"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxxxxx"/><meta name="baidu-site-verification" content="xxxxxxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!true && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle = window.adsbygoogle || []).push({
  google_ad_client: 'ca-pub-3978542742563797',
  enable_page_level_ads: 'true'
});</script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?3c49dd4913ab43efb1bfc8d12b1cded9";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
btf.addGlobalFn('pjaxComplete', () => {
  _hmt.push(['_trackPageview',window.location.pathname])
}, 'baidu_analytics')
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-PF2CVP2PL4"></script><script>window.dataLayer = window.dataLayer || []
function gtag(){dataLayer.push(arguments)}
gtag('js', new Date())
gtag('config', 'G-PF2CVP2PL4')
btf.addGlobalFn('pjaxComplete', () => {
  gtag('config', 'G-PF2CVP2PL4', {'page_path': window.location.pathname})
}, 'google_analytics')
</script><script defer="defer" data-pjax="data-pjax" src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon="{&quot;token&quot;: &quot;17ff914b5e28493597b7dc19f3356022&quot;}"></script><script>(function(c,l,a,r,i,t,y){
    c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
    t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
    y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
})(window, document, "clarity", "script", "tkaenn1tjv");
</script><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
"https://www.googletagmanager.com/gtm.js?id="+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-MF3J339H');
btf.addGlobalFn('pjaxComplete', () => {
  dataLayer.push({'event': 'pjaxComplete', 'page_title': document.title, 'page_location': location.href, 'page_path': window.location.pathname})
}, 'google_tag_manager')</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.json","preload":false,"top_n_per_article":1,"unescape":false,"pagination":{"enable":false,"hitsPerPage":8},"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":400,"highlightFullpage":true,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"已切换为繁体中文","cht_to_chs":"已切换为简体中文","day_to_night":"已切换为深色模式","night_to_day":"已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: true,
  isAnchor: true,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '构建',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 8.0.0"><link rel="alternate" href="/atom.xml" title="wdfk-prog的个人博客" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      if ($loadingBox.classList.contains('loaded')) return
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()

  if (document.readyState === 'complete') {
    preloader.endLoading()
  } else {
    window.addEventListener('load', preloader.endLoading)
    document.addEventListener('DOMContentLoaded', preloader.endLoading)
    // Add timeout protection: force end after 7 seconds
    setTimeout(preloader.endLoading, 7000)
  }

  if (true) {
    btf.addGlobalFn('pjaxSend', preloader.initLoading, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', preloader.endLoading, 'preloader_end')
  }
})()</script><div id="web_bg" style="background-image: url(/images/subtle-texture.png);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/avatar.png" onerror="this.onerror=null;this.src='/images/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">414</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">49</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">53</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-book-open"></i><span> 页面</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-images"></i><span> 图库</span></a></li><li><a class="site-page child" href="/shuoshuo/"><i class="fa-fw fas fa-quote-left"></i><span> 说说</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 示例</span></a></li></ul></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book"></i><span> 书籍</span></a></li><li><a class="site-page child" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li><li><a class="site-page child" href="/songs/"><i class="fa-fw fas fa-music"></i><span> 歌曲</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fas fa-comments"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/images/covers/02.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/my-logo.png" alt="Logo"><span class="site-name">wdfk-prog的个人博客</span></a><a class="nav-page-title" href="/"><span class="site-name">构建</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-book-open"></i><span> 页面</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-images"></i><span> 图库</span></a></li><li><a class="site-page child" href="/shuoshuo/"><i class="fa-fw fas fa-quote-left"></i><span> 说说</span></a></li><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 示例</span></a></li></ul></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book"></i><span> 书籍</span></a></li><li><a class="site-page child" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li><li><a class="site-page child" href="/songs/"><i class="fa-fw fas fa-music"></i><span> 歌曲</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fas fa-comments"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">构建<a class="post-edit-link" href="null_posts/uboot/构建.md" title="编辑" target="_blank"><i class="fas fa-pencil-alt"></i></a></h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-10-03T01:44:27.000Z" title="发表于 2025-10-03 09:44:27">2025-10-03</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-10-03T09:23:27.828Z" title="更新于 2025-10-03 17:23:27">2025-10-03</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/uboot/">uboot</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">2.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>12分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/posts/fe7ede8b/#post-comment"><span class="gitalk-comment-count"><i class="fa-solid fa-spinner fa-spin"></i></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><div id="post-outdate-notice" data="{&quot;limitDay&quot;:365,&quot;messagePrev&quot;:&quot;已经过了&quot;,&quot;messageNext&quot;:&quot;自上次更新以来，文章的内容可能已经过时&quot;,&quot;postUpdate&quot;:&quot;2025-10-03 17:23:27&quot;}" hidden></div><p>[toc]</p>
<h1 id="art-pi构建命令"><a href="#art-pi构建命令" class="headerlink" title="art-pi构建命令"></a>art-pi构建命令</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> CROSS_COMPILE=arm-none-eabi- ARCH=arm</span><br><span class="line">make stm32h750-art-pi_defconfig</span><br><span class="line">make menuconfig</span><br><span class="line">    &gt; Boot options        (console=ttySTM0,115200 root=/dev/ram loglevel=8) Boot arguments</span><br><span class="line">    &gt; Device Drivers &gt; Serial drivers        (115200) Default baudrate</span><br><span class="line">u-boot-v2021.07\<span class="built_in">arch</span>\arm\dts\stm32h750i-art-pi.dts</span><br><span class="line">    chosen &#123;</span><br><span class="line">        bootargs = <span class="string">&quot;root=/dev/ram&quot;</span>;</span><br><span class="line">        stdout-path = <span class="string">&quot;serial0:2000000n8&quot;</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    chosen &#123;</span><br><span class="line">        bootargs = <span class="string">&quot;root=/dev/ram&quot;</span>;</span><br><span class="line">        stdout-path = <span class="string">&quot;serial0:115200n8&quot;</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">make -j 12</span><br></pre></td></tr></table></figure>

<h1 id="F4-构建命令"><a href="#F4-构建命令" class="headerlink" title="F4 构建命令"></a>F4 构建命令</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> CROSS_COMPILE=arm-none-eabi- ARCH=arm</span><br><span class="line">make stm32f429-discovery_defconfig</span><br><span class="line"><span class="built_in">arch</span>/arm/dts/stm32f429-disco.dts</span><br><span class="line">make -j 12</span><br></pre></td></tr></table></figure>

<h1 id="Makefile"><a href="#Makefile" class="headerlink" title="Makefile"></a>Makefile</h1><ul>
<li>查看<a href="./%E5%AD%90%E7%9B%AE%E5%BD%95/Makefile.md">Makefile.md</a></li>
<li>学习的Makefile如下:<a href="./%E5%AD%A6%E4%B9%A0%E8%8A%AF%E7%89%87/ART-PI/Makefile">Makefile</a></li>
</ul>
<h2 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h2><h3 id="V-1-显示完成命令输出"><a href="#V-1-显示完成命令输出" class="headerlink" title="V&#x3D;1 显示完成命令输出"></a>V&#x3D;1 显示完成命令输出</h3><ul>
<li><code>V=1</code>：告诉 <code>make</code> 显示完成的命令输出。这对于调试构建过程非常有用，因为它可以显示构建过程中执行的所有命令。</li>
<li>没有设置 <code>V</code> 时，<code>make</code> 默认不显示命令输出。</li>
<li>其中 <code>Q = @</code>,<code>@</code>用于抑制命令的输出</li>
</ul>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># make V=1 显示完成命令输出</span></span><br><span class="line"><span class="keyword">ifeq</span> (<span class="string">&quot;$(origin V)&quot;</span>, <span class="string">&quot;command line&quot;</span>)	<span class="comment">#获取V是否输入</span></span><br><span class="line">  KBUILD_VERBOSE = <span class="variable">$(V)</span>	<span class="comment"># KBUILD_VERBOSE = 1</span></span><br><span class="line"><span class="keyword">endif</span></span><br><span class="line"><span class="keyword">ifndef</span> KBUILD_VERBOSE	<span class="comment"># 如果没有输入V,则KBUILD_VERBOSE = 0</span></span><br><span class="line">  KBUILD_VERBOSE = 0</span><br><span class="line"><span class="keyword">endif</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ifeq</span> (<span class="variable">$(KBUILD_VERBOSE)</span>,1)	<span class="comment"># 如果KBUILD_VERBOSE = 1,则显示完成命令输出</span></span><br><span class="line">  quiet =</span><br><span class="line">  Q =</span><br><span class="line"><span class="keyword">else</span>	<span class="comment"># 否则不显示完成命令输出</span></span><br><span class="line">  quiet=quiet_</span><br><span class="line">  Q = @</span><br><span class="line"><span class="keyword">endif</span></span><br></pre></td></tr></table></figure>

<h3 id="s-静默模式"><a href="#s-静默模式" class="headerlink" title="-s 静默模式"></a>-s 静默模式</h3><ul>
<li><code>-s</code>：告诉 <code>make</code> 进入静默模式。在静默模式下，<code>make</code> 不会显示构建过程中执行的命令。</li>
<li>设置 <code>quiet</code>变量为 <code>silent_</code>，这样就可以在构建过程中使用 <code>$(quiet)</code>前缀来隐藏命令的输出。</li>
</ul>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ifneq</span> (<span class="variable">$(<span class="built_in">filter</span> 4.%,<span class="variable">$(MAKE_VERSION)</span>)</span>,)	<span class="comment"># make-4</span></span><br><span class="line"><span class="keyword">ifneq</span> (<span class="variable">$(<span class="built_in">filter</span> %s ,$(<span class="built_in">firstword</span> x<span class="variable">$(MAKEFLAGS)</span>)</span>),)</span><br><span class="line">  quiet=silent_</span><br><span class="line"><span class="keyword">endif</span></span><br><span class="line"><span class="keyword">else</span>					<span class="comment"># make-3.8x</span></span><br><span class="line"><span class="keyword">ifneq</span> (<span class="variable">$(<span class="built_in">filter</span> s% -s%,<span class="variable">$(MAKEFLAGS)</span>)</span>,)</span><br><span class="line">  quiet=silent_</span><br><span class="line"><span class="keyword">endif</span></span><br><span class="line"><span class="keyword">endif</span></span><br></pre></td></tr></table></figure>

<h3 id="O-输出目录"><a href="#O-输出目录" class="headerlink" title="O&#x3D; 输出目录"></a>O&#x3D; 输出目录</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make CROSS_COMPILE=arm-none-eabi- ARCH=arm -j3 O=output/</span><br></pre></td></tr></table></figure>

<ul>
<li>使用 <code>KBUILD_SRC</code>设置输出目录。使用 <code>O</code>变量设置输出目录，如果 <code>O</code>变量没有设置，则使用 <code>KBUILD_SRC</code>变量设置输出目录。</li>
</ul>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ifeq</span> (<span class="variable">$(KBUILD_SRC)</span>,)</span><br><span class="line">    <span class="keyword">ifeq</span> (<span class="string">&quot;$(origin O)&quot;</span>, <span class="string">&quot;command line&quot;</span>)</span><br><span class="line">    KBUILD_OUTPUT := <span class="variable">$(O)</span></span><br><span class="line"><span class="keyword">endif</span></span><br></pre></td></tr></table></figure>

<h3 id="C-1-启用静态检查"><a href="#C-1-启用静态检查" class="headerlink" title="C&#x3D;1 启用静态检查"></a>C&#x3D;1 启用静态检查</h3><ul>
<li>使用 ‘make C&#x3D;1’ 来启用仅检查重新编译的文件。</li>
<li>使用 ‘make C&#x3D;2’ 来启用对 <em>所有</em> 源文件的检查，无论它们是否被重新编译。</li>
</ul>
<h3 id="M-构建的外部模块的目录"><a href="#M-构建的外部模块的目录" class="headerlink" title="M &#x3D; 构建的外部模块的目录"></a>M &#x3D; 构建的外部模块的目录</h3><ul>
<li>使用 make M&#x3D;dir 指定要构建的外部模块的目录</li>
<li>旧语法 make …SUBDIRS&#x3D;$PWD 仍受支持</li>
<li>设置环境变量KBUILD_EXTMOD优先</li>
</ul>
<h3 id="cc-option-CC编译器选项测试检查"><a href="#cc-option-CC编译器选项测试检查" class="headerlink" title="cc-option CC编译器选项测试检查"></a>cc-option CC编译器选项测试检查</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># output 目录进行以下测试</span></span><br><span class="line"><span class="comment"># 如果 KBUILD_EXTMOD 被定义，则使用其第一个值作为临时输出目录；否则，TMPOUT 为空。</span></span><br><span class="line">TMPOUT := <span class="variable">$(<span class="built_in">if</span> <span class="variable">$(KBUILD_EXTMOD)</span>,$(<span class="built_in">firstword</span> <span class="variable">$(KBUILD_EXTMOD)</span>)</span>/)</span><br><span class="line"></span><br><span class="line"><span class="comment"># try-run</span></span><br><span class="line"><span class="comment"># Usage: option = $(call try-run, $(CC)...-o &quot;$$TMP&quot;,option-ok,otherwise)</span></span><br><span class="line"><span class="comment"># 退出代码选择选项。“$$TMP” 可以用作临时文件，并会自动清理。</span></span><br><span class="line"><span class="comment"># 针对 U-Boot 进行了修改：防止 cc-option 留下 .*.su 文件</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># set -e 确保在命令失败时立即退出。</span></span><br><span class="line"><span class="comment"># 定义了三个临时文件，分别用于存储编译输出和中间文件。$$$$ 用于生成唯一的文件名。</span></span><br><span class="line"><span class="comment"># 执行编译命令 $(1)，并根据其退出状态选择输出。如果编译成功，输出 $(2)；否则，输出 $(3)。</span></span><br><span class="line"><span class="comment"># 删除临时文件，确保不会留下多余的文件。</span></span><br><span class="line">try-run = <span class="variable">$(<span class="built_in">shell</span> set -e;		\</span></span><br><span class="line"><span class="variable">    TMP=<span class="string">&quot;<span class="variable">$(TMPOUT)</span>.$$$$.tmp&quot;</span>;	\</span></span><br><span class="line"><span class="variable">    TMPO=<span class="string">&quot;<span class="variable">$(TMPOUT)</span>.$$$$.o&quot;</span>;	\</span></span><br><span class="line"><span class="variable">    TMPSU=<span class="string">&quot;<span class="variable">$(TMPOUT)</span>.$$$$.su&quot;</span>;	\</span></span><br><span class="line"><span class="variable">    <span class="built_in">if</span> ($(1)</span>) &gt;/dev/null 2&gt;&amp;1;	\</span><br><span class="line">    then echo <span class="string">&quot;$(2)&quot;</span>;		\</span><br><span class="line">    <span class="keyword">else</span> echo <span class="string">&quot;$(3)&quot;</span>;		\</span><br><span class="line">    fi;				\</span><br><span class="line">    rm -f <span class="string">&quot;$$TMP&quot;</span> <span class="string">&quot;$$TMPO&quot;</span> <span class="string">&quot;$$TMPSU&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># __cc-option</span></span><br><span class="line"><span class="comment"># Usage: MY_CFLAGS += $(call __cc-option,$(CC),$(MY_CFLAGS),-march=winchip-c6,-march=i586)</span></span><br><span class="line"><span class="comment"># $(1) 表示编译器命令（如 $(CC)）。</span></span><br><span class="line"><span class="comment"># $(2) 表示已有的编译标志。</span></span><br><span class="line"><span class="comment"># $(3) 表示要测试的编译选项。</span></span><br><span class="line"><span class="comment"># $(4) 表示备用选项。</span></span><br><span class="line"><span class="comment"># 宏会尝试编译一个空的 C 文件 null，并将输出重定向到临时文件 $$TMP。如果编译成功，则返回 $(3)，否则返回 $(4)</span></span><br><span class="line">__cc-option = <span class="variable">$(<span class="built_in">call</span> try-run,\</span></span><br><span class="line"><span class="variable">    $(1)</span> -Werror $(2) $(3) -c -x c /dev/null -o <span class="string">&quot;$$TMP&quot;</span>,$(3),$(4))</span><br><span class="line"></span><br><span class="line"><span class="comment"># cc-option</span></span><br><span class="line"><span class="comment"># Usage: cflags-y += $(call cc-option,-march=winchip-c6,-march=i586)</span></span><br><span class="line"><span class="comment"># 编译器CC 编译条件KBUILD_CPPFLAGS KBUILD_CFLAGS 成功返回$(1) 失败返回$(2)</span></span><br><span class="line">cc-option = <span class="variable">$(<span class="built_in">call</span> __cc-option, <span class="variable">$(CC)</span>,\</span></span><br><span class="line"><span class="variable">    <span class="variable">$(KBUILD_CPPFLAGS)</span> <span class="variable">$(KBUILD_CFLAGS)</span>,$(1)</span>,$(2))</span><br></pre></td></tr></table></figure>

<h3 id="scripts-用于构建脚本的工具"><a href="#scripts-用于构建脚本的工具" class="headerlink" title="scripts 用于构建脚本的工具"></a>scripts 用于构建脚本的工具</h3><ul>
<li>查看<a href="./%E5%AD%90%E7%9B%AE%E5%BD%95/scripts.md">scripts.md</a></li>
</ul>
<h3 id="Kconfig-相关的功能"><a href="#Kconfig-相关的功能" class="headerlink" title="Kconfig 相关的功能"></a>Kconfig 相关的功能</h3><ul>
<li><code>Kconfig</code> 是一个配置文件，用于定义内核的配置选项。它使用一种类似于 C 语言的语法，包含一系列配置选项和依赖关系。<code>Kconfig</code> 文件通常由 <code>Kconfig</code> 工具解析，生成配置文件（<code>.config</code>）。</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">config          - 使用行定向程序更新当前配置</span><br><span class="line">nconfig         - 使用基于 ncurses 菜单的程序更新当前配置</span><br><span class="line">menuconfig      - 使用基于菜单的程序更新当前配置</span><br><span class="line">xconfig         - 使用基于 Qt 前端的程序更新当前配置</span><br><span class="line">gconfig         - 使用基于 GTK+ 前端的程序更新当前配置</span><br><span class="line">oldconfig       - 使用提供的 .config 作为基础更新当前配置</span><br><span class="line">localmodconfig  - 更新当前配置，禁用未加载的模块</span><br><span class="line">localyesconfig  - 更新当前配置，将本地模块转换为核心</span><br><span class="line">defconfig       - 使用 ARCH 提供的默认配置创建新配置</span><br><span class="line">savedefconfig   - 将当前配置保存为 ./defconfig（最小配置）</span><br><span class="line">allnoconfig     - 创建一个所有选项都回答为 no 的新配置</span><br><span class="line">allyesconfig    - 创建一个所有选项都接受为 yes 的新配置</span><br><span class="line">allmodconfig    - 创建一个尽可能选择模块的新配置</span><br><span class="line">alldefconfig    - 创建一个所有符号都设置为默认值的新配置</span><br><span class="line">randconfig      - 创建一个所有选项都随机回答的新配置</span><br><span class="line">listnewconfig   - 列出新选项</span><br><span class="line">olddefconfig    - 与 oldconfig 相同，但将新符号设置为默认值而不提示</span><br><span class="line">testconfig      - 运行 Kconfig 单元测试（需要 python3 和 pytest）</span><br></pre></td></tr></table></figure>

<ul>
<li>强制使用需修改Kconfig文件</li>
</ul>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mainmenu <span class="string">&quot;U-Boot <span class="variable">$(UBOOTVERSION)</span> Configuration&quot;</span></span><br><span class="line">srctree := .</span><br><span class="line">CC = <span class="variable">$(CROSS_COMPILE)</span>gcc</span><br></pre></td></tr></table></figure>

<h4 id="config-使用行定向程序更新当前配置"><a href="#config-使用行定向程序更新当前配置" class="headerlink" title="config 使用行定向程序更新当前配置"></a>config 使用行定向程序更新当前配置</h4><ul>
<li><p>通过命令 <code>./scripts/kconfig/conf --oldaskconfig Kconfig</code>运行</p>
</li>
<li><p>运行的是命令行版本的配置工具，用于解析Kconfig文件并生成配置文件。</p>
</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">*</span><br><span class="line">* U-Boot  Configuration</span><br><span class="line">*</span><br><span class="line">*</span><br><span class="line">* Compiler: </span><br><span class="line">*</span><br><span class="line">Architecture select</span><br><span class="line">  1. ARC architecture (ARC)</span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">2. ARM architecture (ARM)</span></span><br><span class="line">  3. M68000 architecture (M68K)</span><br><span class="line">  4. MicroBlaze architecture (MICROBLAZE)</span><br><span class="line">  5. MIPS architecture (MIPS)</span><br><span class="line">  6. Nios II architecture (NIOS2)</span><br><span class="line">  7. PowerPC architecture (PPC)</span><br><span class="line">  8. RISC-V architecture (RISCV)</span><br><span class="line">  9. Sandbox (SANDBOX)</span><br><span class="line">  10. SuperH architecture (SH)</span><br><span class="line">  11. x86 architecture (X86)</span><br><span class="line">  12. Xtensa architecture (XTENSA)</span><br><span class="line">choice[1-12?]: 2</span><br><span class="line">*</span><br><span class="line">* Skipping low level initialization functions</span><br><span class="line">*</span><br><span class="line">Skip calls to certain low level initialization functions (SKIP_LOWLEVEL_INIT) [N/y/?] N</span><br><span class="line">Skip call to lowlevel_init during early boot ONLY (SKIP_LOWLEVEL_INIT_ONLY) [N/y/?] N</span><br><span class="line">*</span><br><span class="line">* ARM architecture</span><br><span class="line">*</span><br><span class="line">ARM GICV2 driver (DRIVER_GICV2) [N/y/?] N</span><br><span class="line">ARM GICV3 ITS (GIC_V3_ITS) [N/y/?] N</span><br><span class="line">ARM GICV3 GIC600 SUPPORT (GICV3_SUPPORT_GIC600) [N/y/?] N</span><br><span class="line">Do not enable icache (SYS_ICACHE_OFF) [N/y/?] N</span><br><span class="line">Do not enable dcache (SYS_DCACHE_OFF) [N/y/?] N</span><br><span class="line">CP15 based cache enabling support (SYS_ARM_CACHE_CP15) [N/y/?] N</span><br><span class="line">MMU-based Paged Memory Management Support (SYS_ARM_MMU) [N/y/?] N</span><br><span class="line">Use the ARM v7 PMSA Compliant MPU (SYS_ARM_MPU) [Y/?] y</span><br><span class="line">Select the ARM data write cache policy</span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">1. Write-back (WB) (SYS_ARM_CACHE_WRITEBACK)</span></span><br><span class="line">  2. Write-through (WT) (SYS_ARM_CACHE_WRITETHROUGH)</span><br><span class="line">  3. Write allocation (WA) (SYS_ARM_CACHE_WRITEALLOC)</span><br><span class="line">choice[1-3?]: 0</span><br><span class="line">Select the ARM data write cache policy</span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">1. Write-back (WB) (SYS_ARM_CACHE_WRITEBACK)</span></span><br><span class="line">  2. Write-through (WT) (SYS_ARM_CACHE_WRITETHROUGH)</span><br><span class="line">  3. Write allocation (WA) (SYS_ARM_CACHE_WRITEALLOC)</span><br><span class="line">choice[1-3?]: 1</span><br><span class="line">Enable ARCH_CPU_INIT (ARCH_CPU_INIT) [N/y/?] n</span><br><span class="line">Build U-Boot using the Thumb instruction set (SYS_THUMB_BUILD) [Y/?] y</span><br><span class="line"></span><br><span class="line">ARM PL310 L2 cache controller (SYS_L2_PL310) [N/y/?] n</span><br><span class="line">ARM PL310 L2 cache controller in SPL (SPL_SYS_L2_PL310) [N/y/?] ^C</span><br><span class="line"></span><br><span class="line">embedsky@ubuntu:~/share/u-boot$ ./scripts/kconfig/conf --oldaskconfig Kconfig </span><br></pre></td></tr></table></figure>


<ul>
<li>用法</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">--listnewconfig         列出新的选项</span><br><span class="line">--oldaskconfig          使用行定向程序开始新的配置</span><br><span class="line">--oldconfig             使用提供的 .config 文件作为基础更新配置</span><br><span class="line">--syncconfig            类似于 oldconfig，但生成的配置文件位于 include/&#123;generated/,config/&#125;</span><br><span class="line">--olddefconfig          与 oldconfig 相同，但将新符号设置为默认值</span><br><span class="line">--defconfig &lt;file&gt;      使用 &lt;file&gt; 中定义的默认值创建新的配置</span><br><span class="line">--savedefconfig &lt;file&gt;  将当前最小配置保存到 &lt;file&gt;</span><br><span class="line">--allnoconfig           创建一个所有选项都回答为 no 的新配置</span><br><span class="line">--allyesconfig          创建一个所有选项都回答为 yes 的新配置</span><br><span class="line">--allmodconfig          创建一个所有选项都回答为 mod 的新配置</span><br><span class="line">--alldefconfig          创建一个所有符号都设置为默认值的新配置</span><br><span class="line">--randconfig            创建一个所有选项都随机回答的新配置</span><br></pre></td></tr></table></figure>

<ul>
<li>代码解析</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> ac, <span class="type">char</span> **av)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> *progname = av[<span class="number">0</span>];</span><br><span class="line">    <span class="type">int</span> opt;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> *name, *defconfig_file = <span class="literal">NULL</span> <span class="comment">/* gcc uninit */</span>;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">stat</span> <span class="title">tmpstat</span>;</span></span><br><span class="line">    <span class="type">int</span> no_conf_write = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    tty_stdio = isatty(<span class="number">0</span>) &amp;&amp; isatty(<span class="number">1</span>); <span class="comment">//判断标准输入输出是否指向终端</span></span><br><span class="line">  <span class="comment">//从命令行获取短选项-s参数或者long_opts结构体的选项</span></span><br><span class="line">  <span class="comment">// 执行对应配置操作</span></span><br><span class="line">  <span class="keyword">while</span> ((opt = getopt_long(ac, av, <span class="string">&quot;s&quot;</span>, long_opts, <span class="literal">NULL</span>)) != <span class="number">-1</span>) &#123;</span><br><span class="line">    <span class="comment">//如果存在-s参数,则设置消息输出回调为空,即不输出消息</span></span><br><span class="line">    <span class="keyword">if</span> (opt == <span class="string">&#x27;s&#x27;</span>) &#123;</span><br><span class="line">      conf_set_message_callback(<span class="literal">NULL</span>);</span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//如果 ac 等于 optind，则表示没有提供额外的命令行参数，即没有提供配置文件</span></span><br><span class="line">  <span class="keyword">if</span> (ac == optind) &#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;%s: Kconfig file missing\n&quot;</span>, av[<span class="number">0</span>]);</span><br><span class="line">        conf_usage(progname);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="comment">//获取配置文件</span></span><br><span class="line">  name = av[optind];</span><br><span class="line">    <span class="comment">//执行配置操作</span></span><br><span class="line">  <span class="comment">//通过scripts/kconfig/zconf.y 使用 bison -d zconf.y 生成 zconf.tab.c</span></span><br><span class="line">  <span class="comment">//这里会需要进行用户配置</span></span><br><span class="line">  conf _parse(name);</span><br><span class="line">  <span class="comment">//执行配置操作</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    re turn <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="menuconfig-使用基于菜单的程序更新当前配置"><a href="#menuconfig-使用基于菜单的程序更新当前配置" class="headerlink" title="menuconfig 使用基于菜单的程序更新当前配置"></a>menuconfig 使用基于菜单的程序更新当前配置</h4><ul>
<li>通过命令 <code>./scripts/kconfig/mconf Kconfig </code>运行</li>
<li>运行的是menuconfig的配置工具，使用基于菜单的程序更新当前配置</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">embedsky@ubuntu:~/share/u-boot$ ./scripts/kconfig/mconf Kconfig </span><br><span class="line">.config:37:warning: symbol value &#x27;&#x27; invalid for ENV_OFFSET</span><br><span class="line">.config:38:warning: symbol value &#x27;&#x27; invalid for ENV_SECT_SIZE</span><br><span class="line">.config:47:warning: symbol value &#x27;&#x27; invalid for TPL_STACK</span><br><span class="line">.config:52:warning: symbol value &#x27;&#x27; invalid for SYS_LOAD_ADDR</span><br><span class="line">.config:57:warning: symbol value &#x27;&#x27; invalid for PRE_CON_BUF_ADDR</span><br><span class="line">.config:108:warning: symbol value &#x27;&#x27; invalid for BOARD_SIZE_LIMIT</span><br><span class="line">.config:116:warning: symbol value &#x27;&#x27; invalid for SYS_MONITOR_BASE</span><br><span class="line">.config:827:warning: symbol value &#x27;&#x27; invalid for SYS_SATA_MAX_DEVICE</span><br><span class="line"></span><br><span class="line">WARNING: unmet direct dependencies detected for NPCM_OTP</span><br><span class="line">  Depends on [n]: ARM [=n] &amp;&amp; ARCH_NPCM [=n]</span><br><span class="line">  Selected by [y]:</span><br><span class="line">  - NPCM_AES [=y]</span><br><span class="line">Your display is too small to run Menuconfig!</span><br><span class="line">It m ust be at least 19 lines by 80 columns.</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">WAING: unmet direct dependencies detected for NPCM_OTP</span><br><span class="line"> Dpends on [n]: ARM [=n] &amp;&amp; ARCH_NPCM [=n]</span><br><span class="line"> S lected by [y]:</span><br><span class="line">- NP CM_AES [=y]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> configuration changes were NOT saved.</span><br><span class="line"></span><br><span class="line">`</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">建说明</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">执 make xxx_defconfig`时，会执行conf可执行文件的编译</span><br><span class="line">后执 `./scripts/kconfig/conf --defconfig=generated_defconfig Kconfig`命令，生成配置文件</span><br><span class="line"></span><br><span class="line">`ma</span><br><span class="line"></span><br><span class="line">kefile</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">scripts/kcon fig/Makefile</span>  </span><br><span class="line">  </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"> %</span><span class="language-bash">defconfig: $(obj)/conf</span></span><br><span class="line">    $(Q)$(CPP) -nostdinc -P -I $(srctree) -undef -x assembler-with-cpp $(srctree)/arch/$(SRCARCH)/configs/$@ -o generated_defconfig</span><br><span class="line">    $(Q)$&lt; $(silent) --defconfig=generated_defconfig $(Kconfig)</span><br></pre></td></tr></table></figure>


<ul>
<li>展开为</li>
</ul>
  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">arm-none-eabi-gcc -E -nostdinc -P -I . -undef -x assembler-with-cpp ./arch/../configs/stm32h750-art-pi_defconfig -o generated_defconfig</span><br><span class="line">nfig/conf  --defconfig=generated_defconfig Kconfig</span><br></pre></td></tr></table></figure>



<h2 id="构建流程"><a href="#构建流程" class="headerlink" title="构建流程"></a>构建流程</h2><ul>
<li><a href="./%E5%88%86%E6%9E%90%E6%96%87%E4%BB%B6/make%20all%E5%8F%98%E9%87%8F.log">make -p 查看变量</a></li>
<li><a href="./%E5%AD%90%E7%9B%AE%E5%BD%95/UBOOT%E7%BC%96%E8%AF%91---%20make%20xxx_deconfig%E8%BF%87%E7%A8%8B%E8%AF%A6%E8%A7%A3(%E4%B8%80)%20-%20BSP-%E8%B7%AF%E4%BA%BA%E7%94%B2%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD.mhtml">流程参考</a></li>
</ul>
<h3 id="Ubootb编译第一步通常是执行make-xxx-config"><a href="#Ubootb编译第一步通常是执行make-xxx-config" class="headerlink" title="Ubootb编译第一步通常是执行make xxx_config"></a>Ubootb编译第一步通常是执行make xxx_config</h3><ul>
<li><p>在编译指定顶层目录生成.c onfig文件，这种方式要求厂商 提供一个基础的xxx_config文件(通常来说开发者不会通过执行make menuconfig从零开始配置，这个工作过量太大了)。</p>
</li>
<li><p>查看编译流程时,优先查看 <code>xxx:</code>这类可执行目标;如果make 没有带目标时,则优先查看第一个目标,因为是执行的这个目标;从头开始查看,需要注意查看 <code>include</code>是否引入的 <code>xxx:</code></p>
</li>
<li><p>这里的目标是 <code>xxx_config:</code>,即 <code>%config:</code></p>
</li>
</ul>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义了一个模式规则，匹配所有以 config 结尾的目标</span></span><br><span class="line"><span class="section">%config: scripts_basic outputmakefile FORCE</span></span><br><span class="line">    <span class="variable">$(Q)</span><span class="variable">$(MAKE)</span> <span class="variable">$(build)</span>=scripts/kconfig <span class="variable">$@</span></span><br></pre></td></tr></table></figure>

<ul>
<li>%config 还会依赖于 <code>scripts_basic</code>和 <code>outputmakefile</code>，<code>FORCE</code>是一个空目标，用于强制执行规则。</li>
</ul>
<h4 id="build变量的定义"><a href="#build变量的定义" class="headerlink" title="build变量的定义"></a>build变量的定义</h4><ul>
<li>观察顶层makefile</li>
</ul>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 我们需要一些通用定义（不要尝试重新制作文件）。</span></span><br><span class="line"><span class="comment"># 里面定义了$(build)</span></span><br><span class="line"><span class="section">scripts/Kbuild.include: ;</span></span><br><span class="line"><span class="keyword">include</span> scripts/Kbuild.<span class="keyword">include</span></span><br></pre></td></tr></table></figure>

<ul>
<li>在scripts&#x2F;Kbuild.include 中定义：</li>
</ul>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">###</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Shorthand for $(Q)$(MAKE) -f scripts/Makefile.build obj=</span></span><br><span class="line"><span class="comment"># Usage:</span></span><br><span class="line"><span class="comment"># $(Q)$(MAKE) $(build)=dir</span></span><br><span class="line">build := -f <span class="variable">$(srctree)</span>/scripts/Makefile.build obj</span><br></pre></td></tr></table></figure>

<h4 id="编译scripts-basic-生成fixep"><a href="#编译scripts-basic-生成fixep" class="headerlink" title="编译scripts_basic 生成fixep"></a>编译scripts_basic 生成fixep</h4><ul>
<li><a href="./%E5%AD%90%E7%9B%AE%E5%BD%95/scripts.md">参考</a></li>
</ul>
<h4 id="outputmakefile-生成Makefile"><a href="#outputmakefile-生成Makefile" class="headerlink" title="outputmakefile 生成Makefile"></a>outputmakefile 生成Makefile</h4><h4 id="执行scripts-kconfig-Makefile"><a href="#执行scripts-kconfig-Makefile" class="headerlink" title="执行scripts&#x2F;kconfig Makefile"></a>执行scripts&#x2F;kconfig Makefile</h4><h4 id="编译生成conf"><a href="#编译生成conf" class="headerlink" title="编译生成conf"></a>编译生成conf</h4><h4 id="执行conf-–defconfig-generated-defconfig-Kconfig"><a href="#执行conf-–defconfig-generated-defconfig-Kconfig" class="headerlink" title="执行conf –defconfig&#x3D;generated_defconfig Kconfig"></a>执行conf –defconfig&#x3D;generated_defconfig Kconfig</h4><h4 id="include-config-auto-conf、-include-config-auto-conf-cmd、-include-generated-autoconf-h"><a href="#include-config-auto-conf、-include-config-auto-conf-cmd、-include-generated-autoconf-h" class="headerlink" title="include&#x2F;config&#x2F;auto.conf、 include&#x2F;config&#x2F;auto.conf.cmd、 include&#x2F;generated&#x2F;autoconf.h"></a>include&#x2F;config&#x2F;auto.conf、 include&#x2F;config&#x2F;auto.conf.cmd、 include&#x2F;generated&#x2F;autoconf.h</h4><ul>
<li><a href="./%E5%AD%90%E7%9B%AE%E5%BD%95/UBOOT%E7%BC%96%E8%AF%91---%20include_config_auto.conf%E3%80%81%20include_config_auto.conf.cmd%E3%80%81%20include_generated_autoconf.h%20(%E4%BA%8C)%20-%20BSP-%E8%B7%AF%E4%BA%BA%E7%94%B2%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD.mhtml">参考</a></li>
</ul>
<h3 id="Ubootb编译-执行make-操作"><a href="#Ubootb编译-执行make-操作" class="headerlink" title="Ubootb编译 执行make 操作"></a>Ubootb编译 执行make 操作</h3><ul>
<li><a href="./%E5%AD%90%E7%9B%AE%E5%BD%95/UBOOT%E7%BC%96%E8%AF%91---%20UBOOT%E7%BC%96%E8%AF%91%E8%BF%87%E7%A8%8B%E7%9B%AE%E6%A0%87%E4%BE%9D%E8%B5%96%E5%88%86%E6%9E%90(%E5%85%AB)%20-%20BSP-%E8%B7%AF%E4%BA%BA%E7%94%B2%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD.mhtml">参考</a></li>
<li><a href="./%E5%AD%90%E7%9B%AE%E5%BD%95/u-boot_make.md">详细</a></li>
</ul>
<h1 id="shell-命令"><a href="#shell-命令" class="headerlink" title="shell 命令"></a>shell 命令</h1><ul>
<li>查看<a href="./%E5%AD%90%E7%9B%AE%E5%BD%95/shell%20%E5%91%BD%E4%BB%A4.md">shell.md</a></li>
</ul>
<h1 id="GNU-C"><a href="#GNU-C" class="headerlink" title="GNU C"></a>GNU C</h1><ul>
<li>查看<a href="./%E5%AD%90%E7%9B%AE%E5%BD%95/GNU_C.md">GNU C.md</a></li>
</ul>
<h1 id="objdump-工具"><a href="#objdump-工具" class="headerlink" title="objdump 工具"></a>objdump 工具</h1><h2 id="反汇编-d"><a href="#反汇编-d" class="headerlink" title="反汇编 -d"></a>反汇编 -d</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">objdump -d start.o</span><br></pre></td></tr></table></figure>
<ul>
<li>更多的详细信息，可以使用 -S 选项，它会将源代码和反汇编代码一起显示</li>
<li>问题:<ol>
<li><code>objdump: can&#39;t disassemble for architecture UNKNOWN!</code></li>
</ol>
<ul>
<li>出现这个错误可能是因为 objdump 工具无法识别目标文件的架构。你可以尝试显式指定架构来解决这个问题。</li>
</ul>
  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">objdump -d -m arm start.o</span><br></pre></td></tr></table></figure>

<ul>
<li>使用<code>file</code>命令查看文件类型<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$</span><span class="language-bash">file start.o</span></span><br><span class="line">arch/arm/cpu/armv7m/start.o: ELF 32-bit LSB relocatable, ARM, EABI5 version 1 (SYSV), with debug_info, not stripped</span><br></pre></td></tr></table></figure></li>
<li>使用<code>objdump -i</code>查看支持的架构</li>
<li>根据你的架构 armv7m,使用<code>arm-none-eabi-objdump </code></li>
</ul>
</li>
</ul>
<h2 id="查看段信息-h"><a href="#查看段信息-h" class="headerlink" title="查看段信息 -h"></a>查看段信息 -h</h2><h2 id="显示段内容-s"><a href="#显示段内容-s" class="headerlink" title="显示段内容 -s"></a>显示段内容 -s</h2><h2 id="反汇编指定的段-j"><a href="#反汇编指定的段-j" class="headerlink" title="反汇编指定的段 -j"></a>反汇编指定的段 -j</h2></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/wdfk-prog">Liya Huang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://wdfk-prog.space/posts/fe7ede8b/">https://wdfk-prog.space/posts/fe7ede8b/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://wdfk-prog.space" target="_blank">wdfk-prog的个人博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/uboot/">uboot</a></div><div class="post-share"><div class="social-share" data-image="/images/covers/02.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>赞助</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/images/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/wechat.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/images/alipay.png" target="_blank"><img class="post-qr-code-img" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/alipay.png" alt="支付寶"/></a><div class="post-qr-code-desc">支付寶</div></li></ul></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/posts/dd1e973e/" title="scripts"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/covers/04.jpg" onerror="onerror=null;src='/images/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">scripts</div></div><div class="info-2"><div class="info-item-1">[TOC] scripts 用于构建脚本的工具 参考UBOOT全部目标的编译过程详解  scripts_basic 用于构建基本脚本的工具参考 uboot 和 Linux kernel 的主 Makefile 里面，都有下面这段话： 1234PHONY += scripts_basicscripts_basic:	$(Q)$(MAKE) $(build)=scripts/basic	$(Q)rm -f .tmp_quiet_recordmcount 展开后就是： 1make -f ./scripts/Makefile.build obj=scripts/basic  $(build)的展开主 Makefile 里面，有一个非常重要的 include： 1include scripts/Kbuild.include  这是一个头文件，相当于把 Kbuild.include 的内容直接写到主 Makefile 里。Kbuild.include 代码片段： 12345#### Shorthand for $(Q)$(MAKE) -f scripts/Makefile.build obj...</div></div></div></a><a class="pagination-related" href="/posts/329f510/" title="u-boot 学习笔记"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/covers/10.jpg" onerror="onerror=null;src='/images/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">u-boot 学习笔记</div></div><div class="info-2"><div class="info-item-1">u-boot 学习笔记  u-boot分类   1.1. api 1.1.1. api.md   1.2. arch 1.2.1. arm 1.2.1.1. arm.md 1.2.1.2. assembly.md   1.2.2. arch.md   1.3. boot 1.3.1. bootm.md 1.3.2. bootretry.md 1.3.3. bootz.md 1.3.4. image.md   1.4. cmd 1.4.1. cmd.md   1.5. common 1.5.1. autoboot.md 1.5.2. board.md 1.5.3. cli.md 1.5.4. command.md 1.5.5. console.md 1.5.6. dmalloc.md 1.5.7. event.md 1.5.8. export.md 1.5.9. log.md 1.5.10. main.md   1.6. dm 1.6.1. adc.md 1.6.2. button.md 1.6.3. clock.md 1.6.4. core.md 1.6.5. dts.md 1....</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/posts/329f510/" title="u-boot 学习笔记"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/covers/10.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-10-03</div><div class="info-item-2">u-boot 学习笔记</div></div><div class="info-2"><div class="info-item-1">u-boot 学习笔记  u-boot分类   1.1. api 1.1.1. api.md   1.2. arch 1.2.1. arm 1.2.1.1. arm.md 1.2.1.2. assembly.md   1.2.2. arch.md   1.3. boot 1.3.1. bootm.md 1.3.2. bootretry.md 1.3.3. bootz.md 1.3.4. image.md   1.4. cmd 1.4.1. cmd.md   1.5. common 1.5.1. autoboot.md 1.5.2. board.md 1.5.3. cli.md 1.5.4. command.md 1.5.5. console.md 1.5.6. dmalloc.md 1.5.7. event.md 1.5.8. export.md 1.5.9. log.md 1.5.10. main.md   1.6. dm 1.6.1. adc.md 1.6.2. button.md 1.6.3. clock.md 1.6.4. core.md 1.6.5. dts.md 1....</div></div></div></a><a class="pagination-related" href="/posts/d5eacab8/" title="U-BOOT CLANGD使用 + 避坑注意事项"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/covers/01.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-10-03</div><div class="info-item-2">U-BOOT CLANGD使用 + 避坑注意事项</div></div><div class="info-2"><div class="info-item-1">  [toc]  步骤1 参考如下教程操作;安装clangd + bear https://blog.csdn.net/oushaojun2/article/details/129877412    步骤2 使用方式,看版本 bear make    或者 bear – make    注意事项 出现 Unknown argument: ‘-mword-relocations’ 根目录新建.clangd文件,写入Remove的选项    1234CompileFlags:                     # Tweak the parse settings  Add: [-xc++, -Wall]             # treat all files as C++, enable more warnings  Remove: -W*                     # strip all other warning-related flags  Compiler: clang++               # Change argv[0] of compi...</div></div></div></a><a class="pagination-related" href="/posts/8e01160/" title="objdump反汇编失败的解决办法"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/covers/10.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-10-03</div><div class="info-item-2">objdump反汇编失败的解决办法</div></div><div class="info-2"><div class="info-item-1">  [toc] -m 显示添加目标架构 通常,objdump会自己识别目标架构;如果没有识别出来可以自行添加架构  file命令查看.O文件的架构信息 查看后指定目标架构既可  objdump -i 输出所支持的架构 用于选择-m 的参数要输入什么  交叉编译的使用 由于主机的objdump架构与编译目标的架构不同; 需要使用特定的objdump; 例如armv7m要使用arm-none-eabi-objdump  </div></div></div></a><a class="pagination-related" href="/posts/1d2396de/" title="向u-boot提交补丁的流程"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/covers/03.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-10-03</div><div class="info-item-2">向u-boot提交补丁的流程</div></div><div class="info-2"><div class="info-item-1">  @[toc] 首先需要订阅一下，地址在此https://lists.denx.de/listinfo/u-boot，使邮箱地址对应有一个成员名称，才能向uboot社区发送补丁，否则会收到Post by non-member to a members-only list2. 注册完毕即可发送补丁，发送完之后即可在https://patchwork.ozlabs.org/project/uboot/list/看到了(首次贡献的话发送完补丁后需要等待至少12个小时才会将发送的补丁显示在patchwork上)。   观看如下文档的步骤使用patman工具  https://docs.u-boot.org/en/latest/develop/sending_patches.html   pip install patch-manager  git config sendemail.aliasesfile doc&#x2F;git-mailrc  使用git config --list | grep sendemail检查是否生效   patman send -n试运行,并不会真的发出去...</div></div></div></a><a class="pagination-related" href="/posts/a9a5a729/" title="ubantu st-link 调试"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/covers/08.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-10-03</div><div class="info-item-2">ubantu st-link 调试</div></div><div class="info-2"><div class="info-item-1">  @[toc] Linux如何安装&#x2F;卸载.deb文件 https://blog.csdn.net/vuipp/article/details/126031945   安装.deb 只要输入“sudo dpkg -i 文件名”就可以了  Ubuntu中gcc-arm-none-eabi的安装 https://blog.csdn.net/qq_20016593/article/details/125343260  手动安装(推荐)（1）官网下载：https://developer.arm.com/downloads/-/gnu-rm 1234567pushd .tar -jxf gcc-arm-none-eabi-6-2017-q2-update-linux.tar.bz2sudo mv gcc-arm-none-eabi-6-2017-q2-update /optexportline=&quot;export PATH=/opt/gcc-arm-none-eabi-6-2017-q2-update/bin:\$PATH&quot;if grep -Fxq &quot;$...</div></div></div></a><a class="pagination-related" href="/posts/902266d7/" title="uboot 调试"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/covers/07.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-10-03</div><div class="info-item-2">uboot 调试</div></div><div class="info-2"><div class="info-item-1">  @[toc] 成功debug https://blog.csdn.net/qq_39665253/article/details/145641929  u-boot 配置 https://docs.u-boot.org/en/latest/develop/gdb.html  123CONFIG_CC_OPTIMIZE_FOR_DEBUG=yCONFIG_LTO=n CONFIG_LOG_MAX_LEVEL=9  重新编译.得到u-boot的elf文件(不带后缀就是),可以使用file u-boot确认  ST-LINK debug失败12345678910111213141516171819202122232425262728293031&#123;    &quot;version&quot;: &quot;0.2.0&quot;,    &quot;configurations&quot;: [        &#123;            &quot;name&quot;: &quot;Stlink-Debug&quot;,            &quot;cwd...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/avatar.png" onerror="this.onerror=null;this.src='/images/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Liya Huang</div><div class="author-info-description">WORK-LIFE BALANCE</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">414</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">49</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">53</div></a></div><a id="card-info-btn" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/wdfk-prog"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/wdfk-prog" rel="external nofollow noreferrer" target="_blank" title="GitHub"><i class="fab fa-github" style="color: #181717;"></i></a><a class="social-icon" href="https://wdfk-prog.blog.csdn.net/" rel="external nofollow noreferrer" target="_blank" title="CSDN"><i class="fas fa-blog" style="color: #FC5531;"></i></a><a class="social-icon" href="mailto:1425075683@qq.com" rel="external nofollow noreferrer" target="_blank" title="E-mail"><i class="fas fa-envelope" style="color: #4A4A4A;"></i></a><a class="social-icon" href="/images/wechat-qrcode.jpg" target="_blank" title="微信公众号"><i class="fab fa-weixin" style="color: #07C160;"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fas fa-rss" style="color: #EE802F;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎光临！有任何问题或想法，欢迎在文章下留言交流，或者通过 <a href='/about/'>关于页面</a> 联系我。</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#art-pi%E6%9E%84%E5%BB%BA%E5%91%BD%E4%BB%A4"><span class="toc-number">1.</span> <span class="toc-text">art-pi构建命令</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#F4-%E6%9E%84%E5%BB%BA%E5%91%BD%E4%BB%A4"><span class="toc-number">2.</span> <span class="toc-text">F4 构建命令</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Makefile"><span class="toc-number">3.</span> <span class="toc-text">Makefile</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD"><span class="toc-number">3.1.</span> <span class="toc-text">功能</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#V-1-%E6%98%BE%E7%A4%BA%E5%AE%8C%E6%88%90%E5%91%BD%E4%BB%A4%E8%BE%93%E5%87%BA"><span class="toc-number">3.1.1.</span> <span class="toc-text">V&#x3D;1 显示完成命令输出</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#s-%E9%9D%99%E9%BB%98%E6%A8%A1%E5%BC%8F"><span class="toc-number">3.1.2.</span> <span class="toc-text">-s 静默模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#O-%E8%BE%93%E5%87%BA%E7%9B%AE%E5%BD%95"><span class="toc-number">3.1.3.</span> <span class="toc-text">O&#x3D; 输出目录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#C-1-%E5%90%AF%E7%94%A8%E9%9D%99%E6%80%81%E6%A3%80%E6%9F%A5"><span class="toc-number">3.1.4.</span> <span class="toc-text">C&#x3D;1 启用静态检查</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#M-%E6%9E%84%E5%BB%BA%E7%9A%84%E5%A4%96%E9%83%A8%E6%A8%A1%E5%9D%97%E7%9A%84%E7%9B%AE%E5%BD%95"><span class="toc-number">3.1.5.</span> <span class="toc-text">M &#x3D; 构建的外部模块的目录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cc-option-CC%E7%BC%96%E8%AF%91%E5%99%A8%E9%80%89%E9%A1%B9%E6%B5%8B%E8%AF%95%E6%A3%80%E6%9F%A5"><span class="toc-number">3.1.6.</span> <span class="toc-text">cc-option CC编译器选项测试检查</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#scripts-%E7%94%A8%E4%BA%8E%E6%9E%84%E5%BB%BA%E8%84%9A%E6%9C%AC%E7%9A%84%E5%B7%A5%E5%85%B7"><span class="toc-number">3.1.7.</span> <span class="toc-text">scripts 用于构建脚本的工具</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Kconfig-%E7%9B%B8%E5%85%B3%E7%9A%84%E5%8A%9F%E8%83%BD"><span class="toc-number">3.1.8.</span> <span class="toc-text">Kconfig 相关的功能</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#config-%E4%BD%BF%E7%94%A8%E8%A1%8C%E5%AE%9A%E5%90%91%E7%A8%8B%E5%BA%8F%E6%9B%B4%E6%96%B0%E5%BD%93%E5%89%8D%E9%85%8D%E7%BD%AE"><span class="toc-number">3.1.8.1.</span> <span class="toc-text">config 使用行定向程序更新当前配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#menuconfig-%E4%BD%BF%E7%94%A8%E5%9F%BA%E4%BA%8E%E8%8F%9C%E5%8D%95%E7%9A%84%E7%A8%8B%E5%BA%8F%E6%9B%B4%E6%96%B0%E5%BD%93%E5%89%8D%E9%85%8D%E7%BD%AE"><span class="toc-number">3.1.8.2.</span> <span class="toc-text">menuconfig 使用基于菜单的程序更新当前配置</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%84%E5%BB%BA%E6%B5%81%E7%A8%8B"><span class="toc-number">3.2.</span> <span class="toc-text">构建流程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Ubootb%E7%BC%96%E8%AF%91%E7%AC%AC%E4%B8%80%E6%AD%A5%E9%80%9A%E5%B8%B8%E6%98%AF%E6%89%A7%E8%A1%8Cmake-xxx-config"><span class="toc-number">3.2.1.</span> <span class="toc-text">Ubootb编译第一步通常是执行make xxx_config</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#build%E5%8F%98%E9%87%8F%E7%9A%84%E5%AE%9A%E4%B9%89"><span class="toc-number">3.2.1.1.</span> <span class="toc-text">build变量的定义</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%96%E8%AF%91scripts-basic-%E7%94%9F%E6%88%90fixep"><span class="toc-number">3.2.1.2.</span> <span class="toc-text">编译scripts_basic 生成fixep</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#outputmakefile-%E7%94%9F%E6%88%90Makefile"><span class="toc-number">3.2.1.3.</span> <span class="toc-text">outputmakefile 生成Makefile</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%A7%E8%A1%8Cscripts-kconfig-Makefile"><span class="toc-number">3.2.1.4.</span> <span class="toc-text">执行scripts&#x2F;kconfig Makefile</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%96%E8%AF%91%E7%94%9F%E6%88%90conf"><span class="toc-number">3.2.1.5.</span> <span class="toc-text">编译生成conf</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%A7%E8%A1%8Cconf-%E2%80%93defconfig-generated-defconfig-Kconfig"><span class="toc-number">3.2.1.6.</span> <span class="toc-text">执行conf –defconfig&#x3D;generated_defconfig Kconfig</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#include-config-auto-conf%E3%80%81-include-config-auto-conf-cmd%E3%80%81-include-generated-autoconf-h"><span class="toc-number">3.2.1.7.</span> <span class="toc-text">include&#x2F;config&#x2F;auto.conf、 include&#x2F;config&#x2F;auto.conf.cmd、 include&#x2F;generated&#x2F;autoconf.h</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Ubootb%E7%BC%96%E8%AF%91-%E6%89%A7%E8%A1%8Cmake-%E6%93%8D%E4%BD%9C"><span class="toc-number">3.2.2.</span> <span class="toc-text">Ubootb编译 执行make 操作</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#shell-%E5%91%BD%E4%BB%A4"><span class="toc-number">4.</span> <span class="toc-text">shell 命令</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GNU-C"><span class="toc-number">5.</span> <span class="toc-text">GNU C</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#objdump-%E5%B7%A5%E5%85%B7"><span class="toc-number">6.</span> <span class="toc-text">objdump 工具</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8D%E6%B1%87%E7%BC%96-d"><span class="toc-number">6.1.</span> <span class="toc-text">反汇编 -d</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E6%AE%B5%E4%BF%A1%E6%81%AF-h"><span class="toc-number">6.2.</span> <span class="toc-text">查看段信息 -h</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%98%BE%E7%A4%BA%E6%AE%B5%E5%86%85%E5%AE%B9-s"><span class="toc-number">6.3.</span> <span class="toc-text">显示段内容 -s</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8D%E6%B1%87%E7%BC%96%E6%8C%87%E5%AE%9A%E7%9A%84%E6%AE%B5-j"><span class="toc-number">6.4.</span> <span class="toc-text">反汇编指定的段 -j</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/1db9a982/" title="ext4"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/covers/04.jpg" onerror="this.onerror=null;this.src='/images/404.jpg'" alt="ext4"/></a><div class="content"><a class="title" href="/posts/1db9a982/" title="ext4">ext4</a><time datetime="2025-10-07T03:18:15.310Z" title="更新于 2025-10-07 11:18:15">2025-10-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/b554c0f0/" title="mbcache"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/covers/03.jpg" onerror="this.onerror=null;this.src='/images/404.jpg'" alt="mbcache"/></a><div class="content"><a class="title" href="/posts/b554c0f0/" title="mbcache">mbcache</a><time datetime="2025-10-07T03:16:04.099Z" title="更新于 2025-10-07 11:16:04">2025-10-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/88ab2b13/" title="fs-writeback"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/covers/08.jpg" onerror="this.onerror=null;this.src='/images/404.jpg'" alt="fs-writeback"/></a><div class="content"><a class="title" href="/posts/88ab2b13/" title="fs-writeback">fs-writeback</a><time datetime="2025-10-07T03:08:29.811Z" title="更新于 2025-10-07 11:08:29">2025-10-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/2089198e/" title="filesystems"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/covers/03.jpg" onerror="this.onerror=null;this.src='/images/404.jpg'" alt="filesystems"/></a><div class="content"><a class="title" href="/posts/2089198e/" title="filesystems">filesystems</a><time datetime="2025-10-07T02:52:10.933Z" title="更新于 2025-10-07 10:52:10">2025-10-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/933a291e/" title="hweight"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/covers/10.jpg" onerror="this.onerror=null;this.src='/images/404.jpg'" alt="hweight"/></a><div class="content"><a class="title" href="/posts/933a291e/" title="hweight">hweight</a><time datetime="2025-10-07T02:49:48.378Z" title="更新于 2025-10-07 10:49:48">2025-10-07</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/images/covers/02.jpg);"><div class="footer-flex"><div class="footer-flex-items"><div class="footer-flex-item"><div class="footer-flex-title">文档</div><div class="footer-flex-content"><a href="/categories/linux/" target="_blank" title="🚀 linux">🚀 linux</a><a href="/categories/rt-thread/" target="_blank" title="📑 rt-thread">📑 rt-thread</a><a href="/categories/uboot/" target="_blank" title="📌 uboot">📌 uboot</a><a href="/categories/LoraWan/" target="_blank" title="⚔️ LoraWan">⚔️ LoraWan</a><a href="/categories/hpatch/" target="_blank" title="❓ hpatch">❓ hpatch</a><a href="/categories/git/" target="_blank" title="⚡️ git">⚡️ git</a></div></div></div><div class="footer-flex-items"><div class="footer-flex-item"><div class="footer-flex-title">其他</div><div class="footer-flex-content"><a href="/gallery/" target="_blank" title="图库">图库</a><a href="/messageboard/" target="_blank" title="留言板">留言板</a><a href="/shuoshuo/" target="_blank" title="说说">说说</a><a href="/link/" target="_blank" title="示例">示例</a><a href="/link/" target="_blank" title="友链">友链</a></div></div></div><div class="footer-flex-items"><div class="footer-flex-item"><div class="footer-flex-title">框架</div><div class="footer-flex-content"><a href="https://hexo.io/zh-cn/" rel="external nofollow noreferrer" target="_blank" title="Hexo">Hexo</a><a href="https://butterfly.js.org/" rel="external nofollow noreferrer" target="_blank" title="Butterfly">Butterfly</a></div></div></div><div class="footer-flex-items"><div class="footer-flex-item"><div class="footer-flex-title">贊助</div><div class="footer-flex-content"><div><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/images/alipay.png" alt='wdfk_prog' width='100px' height='100px'></div></div></div></div></div><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 By Liya Huang</span><span class="framework-info"><span class="footer-separator">|</span><span>框架 </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io">Hexo 8.0.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.1</a></span></div><div class="footer_custom_text">你好，欢迎来到我的 <a href="/about/">数字花园</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat-btn" type="button" title="聊天" style="display:none"><i class="fas fa-message"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = `%%{init:{ 'theme':'${theme}'}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (true) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script><script>(() => {
  const applyThemeDefaultsConfig = theme => {
    if (theme === 'dark-mode') {
      Chart.defaults.color = "rgba(255, 255, 255, 0.8)"
      Chart.defaults.borderColor = "rgba(255, 255, 255, 0.2)"
      Chart.defaults.scale.ticks.backdropColor = "transparent"
    } else {
      Chart.defaults.color = "rgba(0, 0, 0, 0.8)"
      Chart.defaults.borderColor = "rgba(0, 0, 0, 0.1)"
      Chart.defaults.scale.ticks.backdropColor = "transparent"
    }
  }

  // Recursively traverse the config object and automatically apply theme-specific color schemes
  const applyThemeConfig = (obj, theme) => {
    if (typeof obj !== 'object' || obj === null) return

    Object.keys(obj).forEach(key => {
      const value = obj[key]
      // If the property is an object and has theme-specific options, apply them
      if (typeof value === 'object' && value !== null) {
        if (value[theme]) {
          obj[key] = value[theme] // Apply the value for the current theme
        } else {
          // Recursively process child objects
          applyThemeConfig(value, theme)
        }
      }
    })
  }

  const runChartJS = ele => {
    window.loadChartJS = true

    Array.from(ele).forEach((item, index) => {
      const chartSrc = item.firstElementChild
      const chartID = item.getAttribute('data-chartjs-id') || ('chartjs-' + index) // Use custom ID or default ID
      const width = item.getAttribute('data-width')
      const existingCanvas = document.getElementById(chartID)

      // If a canvas already exists, remove it to avoid rendering duplicates
      if (existingCanvas) {
          existingCanvas.parentNode.remove()
      }

      const chartDefinition = chartSrc.textContent
      const canvas = document.createElement('canvas')
      canvas.id = chartID

      const div = document.createElement('div')
      div.className = 'chartjs-wrap'

      if (width) {
        div.style.width = width
      }

      div.appendChild(canvas)
      chartSrc.insertAdjacentElement('afterend', div)

      const ctx = document.getElementById(chartID).getContext('2d')

      const config = JSON.parse(chartDefinition)

      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark-mode' : 'light-mode'

      // Set default styles (initial setup)
      applyThemeDefaultsConfig(theme)

      // Automatically traverse the config and apply dual-mode color schemes
      applyThemeConfig(config, theme)

      new Chart(ctx, config)
    })
  }

  const loadChartJS = () => {
    const chartJSEle = document.querySelectorAll('#article-container .chartjs-container')
    if (chartJSEle.length === 0) return

    window.loadChartJS ? runChartJS(chartJSEle) : btf.getScript('https://cdn.jsdelivr.net/npm/chart.js/dist/chart.umd.min.js').then(() => runChartJS(chartJSEle))
  }

  // Listen for theme change events
  btf.addGlobalFn('themeChange', loadChartJS, 'chartjs')
  btf.addGlobalFn('encrypt', loadChartJS, 'chartjs')

  window.pjax ? loadChartJS() : document.addEventListener('DOMContentLoaded', loadChartJS)
})()</script><script>(() => {
  const abcjsInit = () => {
    const abcjsFn = () => {
      setTimeout(() => {
        const sheets = document.querySelectorAll(".abc-music-sheet")
        for (let i = 0; i < sheets.length; i++) {
          const ele = sheets[i]
          if (ele.children.length > 0) continue

          // Parse parameters from data-params attribute
          let params = {}
          const dp = ele.getAttribute("data-params")
          if (dp) {
            try {
              params = JSON.parse(dp)
            } catch (e) {
              console.error("Failed to parse data-params:", e)
            }
          }

          // Merge parsed parameters with the responsive option
          // Ensures params content appears before responsive
          const options = { ...params, responsive: "resize" }

          // Render the music score using ABCJS.renderAbc
          ABCJS.renderAbc(ele, ele.innerHTML, options)
        }
      }, 100)
    }

    if (typeof ABCJS === "object") {
      abcjsFn()
    } else {
      btf.getScript("https://cdn.jsdelivr.net/npm/abcjs/dist/abcjs-basic-min.min.js").then(abcjsFn)
    }
  }

  if (window.pjax) {
    abcjsInit()
  } else {
    window.addEventListener("load", abcjsInit)
  }

  btf.addGlobalFn("encrypt", abcjsInit, "abcjs")
})()</script><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const commentCount = n => {
    const isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
    if (isCommentCount) {
      isCommentCount.textContent= n
    }
  }

  const initGitalk = (el, path) => {
    if (isShuoshuo) {
      window.shuoshuoComment.destroyGitalk = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }

    const gitalk = new Gitalk({
      clientID: 'Ov23livBmwx65h3XIdfT',
      clientSecret: '9f23bdaa2ea11322f9f405d77bcdc27166077a7d',
      repo: 'wdfk-prog.github.io',
      owner: 'wdfk-prog',
      admin: ['wdfk-prog'],
      updateCountCallback: commentCount,
      ...option,
      id: isShuoshuo ? path : (option && option.id) || '8ad70ea21a1f91fc392be0c7d2dc28cd'
    })

    gitalk.render('gitalk-container')
  }

  const loadGitalk = async(el, path) => {
    if (typeof Gitalk === 'function') initGitalk(el, path)
    else {
      await btf.getCSS('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css')
      await btf.getScript('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.js')
      initGitalk(el, path)
    }
  }

  if (isShuoshuo) {
    'Gitalk' === 'Gitalk'
      ? window.shuoshuoComment = { loadComment: loadGitalk }
      : window.loadOtherComment = loadGitalk
    return
  }

  if ('Gitalk' === 'Gitalk' || !false) {
    if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
    else loadGitalk()
  } else {
    window.loadOtherComment = loadGitalk
  }
})()</script></div><script>window.newestComments = {
  changeContent: content => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<code>.*?<\/code>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g, "") // remove html tag

    if (content.length > 150) {
      content = content.substring(0, 150) + '...'
    }
    return content
  },

  generateHtml: (array, ele) => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class="aside-list-item">'

        if (true && array[i].avatar) {
          const imgAttr = 'data-lazy-src'
          const lazyloadNative = ''
          result += `<a href="${array[i].url}" class="thumbnail"><img ${imgAttr}="${array[i].avatar}" alt="${array[i].nick}" ${lazyloadNative}></a>`
        }

        result += `<div class="content">
        <a class="comment" href="${array[i].url}" title="${array[i].content}">${array[i].content}</a>
        <div class="name"><span>${array[i].nick} / </span><time datetime="${array[i].date}">${btf.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += '暂无评论'
    }

    ele.innerHTML = result
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh(ele)
  },

  newestCommentInit: (name, getComment) => {
    const $dom = document.querySelector('#card-newest-comments .aside-list')
    if ($dom) {
      const data = btf.saveToLocal.get(name)
      if (data) {
        newestComments.generateHtml(JSON.parse(data), $dom)
      } else {
        getComment($dom)
      }
    }
  },

  run: (name, getComment) => {
    newestComments.newestCommentInit(name, getComment)
    btf.addGlobalFn('pjaxComplete', () => newestComments.newestCommentInit(name, getComment), name)
  }
}</script><script>window.addEventListener('load', () => {
  const keyName = 'github-newest-comments'
  const { changeContent, generateHtml, run } = window.newestComments

  const findTrueUrl = (array, ele) => {
    Promise.all(array.map(item =>
      fetch(item.url).then(resp => resp.json()).then(data => {
        let urlArray = data.body ? data.body.match(/(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?/ig) : []
        if (!Array.isArray(urlArray) || urlArray.length === 0) {
          urlArray = [`${data.html_url}`]
        }
        if (data.user.login === 'utterances-bot') {
          return urlArray.pop()
        } else {
          return urlArray.shift()
        }
      })
    )).then(res => {
        array = array.map((i,index)=> {
          return {
            ...i,
            url: res[index]
          }
        })

        btf.saveToLocal.set(keyName, JSON.stringify(array), 10/(60*24))
        generateHtml(array, ele)
    });
  }

  const getComment = ele => {
    fetch('https://api.github.com/repos/wdfk-prog/wdfk-prog.github.io/issues/comments?sort=updated&direction=desc&per_page=6&page=1',{
      "headers": {
        Accept: 'application/vnd.github.v3.html+json'
      }
    })
      .then(response => response.json())
      .then(data => {
        const githubArray = data.map(item => {
          return {
            'avatar': item.user.avatar_url,
            'content': changeContent(item.body_html || item.body),
            'nick': item.user.login,
            'url': item.issue_url,
            'date': item.updated_at
          }
        })
        findTrueUrl(githubArray, ele)
      }).catch(e => {
        console.error(e)
        ele.textContent= "无法获取评论，请确认相关配置是否正确"
      })
  }
  run(keyName, getComment)
})</script><div class="aplayer no-destroy" data-id="60198" data-server="netease" data-type="playlist" data-fixed="true" data-autoplay="false" data-volume="0.5"></div><script>
  var titleTime, OriginTitile = document.title;
  document.addEventListener("visibilitychange", function() {
    if (document.hidden) {
      titleTime = setTimeout(function() {
        document.title = "w(ﾟДﾟ)w 不要走！再看看嘛！";
      }, 300);
    } else {
      document.title = "♪(^∇^*)欢迎回来！" + OriginTitile;
      titleTime = setTimeout(function() {
        document.title = OriginTitile;
      }, 2000);
    }
  });
</script>
<script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><script>(() => {
  window.ChatraID = '5cPWcnA8HKGzg5hoc'
  window.Chatra = window.Chatra || function() {
    (window.Chatra.q = window.Chatra.q || []).push(arguments)
  }

  btf.getScript('https://call.chatra.io/chatra.js').then(() => {
    const isChatBtn = true
    const isChatHideShow = true

    if (isChatBtn) {
      const close = () => {
        Chatra('minimizeWidget')
        Chatra('hide')
      }

      const open = () => {
        Chatra('openChat', true)
        Chatra('show')
      }

      window.ChatraSetup = { startHidden: true }
    
      window.chatBtnFn = () => document.getElementById('chatra').classList.contains('chatra--expanded') ? close() : open()

      document.getElementById('chat-btn').style.display = 'block'
    } else if (isChatHideShow) {
      window.chatBtn = {
        hide: () => Chatra('hide'),
        show: () => Chatra('show')
      }
    }
  })
})()</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script>(() => {
  const destroyAplayer = () => {
    if (window.aplayers) {
      for (let i = 0; i < window.aplayers.length; i++) {
        if (!window.aplayers[i].options.fixed) {
          window.aplayers[i].destroy()
        }
      }
    }
  }

  const runMetingJS = () => {
    typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()
  }

  btf.addGlobalFn('pjaxSend', destroyAplayer, 'destroyAplayer')
  btf.addGlobalFn('pjaxComplete', loadMeting, 'runMetingJS')
})()</script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>(() => {
  const pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

  window.pjax = new Pjax({
    elements: 'a:not([target="_blank"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: true,
    scrollRestoration: false
  })

  const triggerPjaxFn = (val) => {
    if (!val) return
    Object.values(val).forEach(fn => {
      try {
        fn()
      } catch (err) {
        console.debug('Pjax callback failed:', err)
      }
    })
  }

  document.addEventListener('pjax:send', () => {
    // removeEventListener
    btf.removeGlobalFnEvent('pjaxSendOnce')
    btf.removeGlobalFnEvent('themeChange')

    // reset readmode
    const $bodyClassList = document.body.classList
    if ($bodyClassList.contains('read-mode')) $bodyClassList.remove('read-mode')

    triggerPjaxFn(window.globalFn.pjaxSend)
  })

  document.addEventListener('pjax:complete', () => {
    btf.removeGlobalFnEvent('pjaxCompleteOnce')
    document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
    })

    triggerPjaxFn(window.globalFn.pjaxComplete)
  })

  document.addEventListener('pjax:error', e => {
    if (e.request.status === 404) {
      const usePjax = true
      true
        ? (usePjax ? pjax.loadUrl('/404.html') : window.location.href = '/404.html')
        : window.location.href = e.request.responseURL
    }
  })
})()</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><i class="fas fa-spinner fa-pulse" id="loading-status" hidden="hidden"></i><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="local-search-input"><input placeholder="搜索文章" type="text"/></div><hr/><div id="local-search-results"></div><div class="ais-Pagination" id="local-search-pagination" style="display:none;"><ul class="ais-Pagination-list"></ul></div><div id="local-search-stats"></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MF3J339H" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript></div><script src="https://cdn.jsdelivr.net/npm/echarts@5.5.1/dist/echarts.min.js"></script>
        
        <script>
            document.addEventListener("DOMContentLoaded", function() {
                const heatmapChartDom = document.getElementById('heatmapChart');
                if(heatmapChartDom){
                    const heatmapChart = echarts.init(heatmapChartDom, 'dark');
                    const cellSize = [18, 18];
                    
                    const groupByYear = (data) => {
                        const result = {};
                        data.forEach(([date, value]) => {
                            const [year] = date.split('-').map(Number);
                            if (!result[year]) {
                                result[year] = [];
                            }
                            result[year].push([date, value]);
                        });
                        return result;
                    };
                    
                    const groupedData = groupByYear([["2025-10-03",392],["2025-10-04",5],["2025-10-06",9],["2025-10-07",8]]);
                    const years = Object.keys(groupedData).reverse();
                    
                    var initYear = parseInt(heatmapChartDom.getAttribute('year')) || new Date().getFullYear();
                    const minYear = years[years.length - 1];
                    const maxYear = years[0];
                    if (initYear < minYear || initYear > maxYear) {
                        initYear = maxYear;
                    }
                    console.log('[hexo-graph]generateHeatmapChart|initYear:', initYear, 'minYear:', minYear, 'maxYear:', maxYear);
                    
                    heatmapChart.setOption({
                        grid: {},
                        tooltip: { 
                            position: 'top', 
                            formatter: params => `${params.value[0]}: ${params.value[1]} Articles` 
                        },
                        calendar: { 
                            top: '10%',
                            left: 'left', 
                            right: '8%',
                            range: initYear,
                            cellSize: cellSize, 
                            splitLine: { lineStyle: { color: '#E0E0E0', width: 1 } }, 
                            itemStyle: { borderWidth: 1, borderColor: '#E0E0E0' }, 
                            dayLabel: { show: false },
                            monthLabel: { show: true },
                            yearLabel: { show: false },
                        },
                        visualMap: { 
                            show: true,
                            right: '8%',
                            bottom: '5%',
                            type: 'piecewise',
                            orient: 'horizontal',
                            text: ['More', 'Less'],
                            min: 0,
                            max: Math.max(...groupedData[initYear].map(item => item[1])),
                            inRange: { color: ["#ACE7AE","#69C16D","#549F57"] }
                        },
                        legend: {
                            type: 'scroll',
                            icon: 'none',
                            data: years,
                            orient: 'vertical',
                            top: '5%',
                            right: 'right',
                            itemWidth: 20,
                            itemHeight: 20,
                            itemGap: 10,
                            pageIconSize: 10,
                            pageTextStyle: { fontSize: 14 },
                            selectedMode: 'single',
                        },
                        series: years.map(year => ({
                            type: 'heatmap',
                            coordinateSystem: 'calendar',
                            data: groupedData[year],
                            name: year,
                            emphasis: {
                                disabled: true,
                            },
                            silent: year !== initYear,
                        })),
                    });
                    
                    // init selected year
                    heatmapChart.dispatchAction({
                        type: 'legendSelect',
                        name: initYear,
                    });
                    
                    heatmapChart.on('legendselectchanged', function(params) {
                        console.log('[hexo-graph]generateHeatmapChart|legendselectchanged:', params);
                        const selectedYear = Object.keys(params.selected).find(key => params.selected[key]);
                        if (selectedYear && groupedData[selectedYear]) {
                            heatmapChart.setOption({
                                calendar: {
                                    range: selectedYear,
                                },
                                visualMap: {
                                    max: Math.max(...groupedData[selectedYear].map(item => item[1])),
                                },
                                series: years.map(year => ({
                                    type: 'heatmap',
                                    coordinateSystem: 'calendar',
                                    data: groupedData[year],
                                    name: year,
                                    emphasis: {
                                        disabled: true,
                                    },
                                    silent: year !== selectedYear,
                                })),
                            });
                        }
                    });
                    
                    heatmapChart.on('click', function (params) {
                        if (params.componentType === 'series') {
                            const [year, month] = params.value[0].split('-');
                            window.location.href = '/archives/' + year + '/' + month;
                        }
                    });
                }
            });
        </script>
    
        
        <script>
            document.addEventListener("DOMContentLoaded", function() {
                const monthlyChartDom = document.getElementById('monthlyChart');
                if(monthlyChartDom){
                    const monthlyChart = echarts.init(monthlyChartDom, 'dark');
                    monthlyChart.setOption({
                        xAxis: { 
                            type: 'category', 
                            data: ["2025-10"], 
                            axisLabel: { fontSize: 14, fontWeight: 'bold', fontFamily: 'Microsoft YaHei, SimSun, serif' }
                        },
                        yAxis: { type: 'value', splitLine: { lineStyle: { type: 'dashed', color: '#ccc' } } },
                        series: [{
                            name: 'Articles',
                            type: 'line',
                            data: [414],
                            smooth: true,
                            lineStyle: { color: '#5470C6', width: 2 },
                            itemStyle: { color: '#5470C6' },
                            areaStyle: { color: 'rgba(84, 112, 198, 0.4)' },
                            symbolSize: 10,
                            label: {
                                show: true,
                                position: 'top',
                                formatter: params => params.value,
                                fontSize: 14,
                                color: '#000',
                                fontWeight: 'bold',
                                fontFamily: 'Microsoft YaHei, SimSun, serif'
                            }
                        }]
                    });

                    monthlyChart.on('click', function (params) {
                        const [year, month] = params.name.split('-');
                        window.location.href = '/archives/' + year + '/' + month;
                    });
                }
            })
        </script>
    
        
        <script>
            document.addEventListener("DOMContentLoaded", function() {
                const tagsChartDom = document.getElementById('tagsChart');
                if(tagsChartDom){
                    const tagsChart = echarts.init(tagsChartDom, 'dark');
                    tagsChart.setOption({
                        tooltip: { trigger: 'item', formatter: '{b}: {c} ({d}%)' },
                        series: [{
                            type: 'pie',
                            radius: '60%',
                            data: [{"name":"linux","value":227},{"name":"uboot","value":68},{"name":"kernel","value":61},{"name":"rt-thread","value":44},{"name":"u-boot分类","value":44},{"name":"drivers","value":39},{"name":"fs","value":37},{"name":"other","value":28}],
                            label: {
                                position: 'outside',
                                formatter: '{b} {c} ({d}%)',
                                fontSize: 14,
                                fontWeight: 'bold',
                                fontFamily: 'Microsoft YaHei, SimSun, serif'
                            },
                            color: ["#5470C6","#91CC75","#FAC858","#EE6666","#73C0DE","#3BA272","#FC8452","#9A60B4"],
                            labelLine: { show: true }
                        }],
                        legend: {
                            bottom: '0',
                            left: 'center',
                            data: [{"name":"linux","value":227},{"name":"uboot","value":68},{"name":"kernel","value":61},{"name":"rt-thread","value":44},{"name":"u-boot分类","value":44},{"name":"drivers","value":39},{"name":"fs","value":37},{"name":"other","value":28}].map(tag => tag.name),
                            textStyle: { fontSize: 14, fontWeight: 'bold', fontFamily: 'Microsoft YaHei, SimSun, serif' }
                        }
                    });

                    tagsChart.on('click', function (params) {
                        window.location.href = '/tags/' + params.name;
                    });
                }
            })
        </script>
    
        
        <script>
            document.addEventListener("DOMContentLoaded", function() {
                const categoriesChartDom = document.getElementById('categoriesChart');
                if(categoriesChartDom){
                    const categoriesChart = echarts.init(categoriesChartDom, 'dark');
                    categoriesChart.setOption({
                        xAxis: { type: 'value', splitLine: { lineStyle: { type: 'dashed', color: '#ccc' } } },
                        yAxis: { 
                            type: 'category', 
                            data: [{"name":"linux","value":227},{"name":"uboot","value":68},{"name":"kernel","value":61},{"name":"rt-thread","value":44},{"name":"u-boot分类","value":44}].map(category => category.name).reverse(), 
                            axisLabel: { fontSize: 14, fontWeight: 'bold', fontFamily: 'Microsoft YaHei, SimSun, serif' }
                        },
                        series: [{
                            name: 'Category Count',
                            type: 'bar',
                            data: [{"name":"linux","value":227},{"name":"uboot","value":68},{"name":"kernel","value":61},{"name":"rt-thread","value":44},{"name":"u-boot分类","value":44}].map(category => category.value).reverse(),
                            label: {
                                show: true,
                                position: 'right',
                                formatter: params => params.value,
                                fontSize: 14,
                                color: '#000',
                                fontWeight: 'bold',
                                fontFamily: 'Microsoft YaHei, SimSun, serif'
                            },
                            itemStyle: {
                                color: new echarts.graphic.LinearGradient(0, 0, 1, 0, [
                                    { offset: 0, color: '#91CC75' },
                                    { offset: 1, color: '#73C0DE' }
                                ])
                            }
                        }]
                    });

                    categoriesChart.on('click', function (params) {
                        window.location.href = '/categories/' + params.name;
                    });
                }
            });
        </script>
    
        
        <script>
            document.addEventListener("DOMContentLoaded", function() {
                const categoriesTreeChartDom = document.getElementById('categoriesTreeChart');
                if(categoriesTreeChartDom){
                    const treeChart = echarts.init(categoriesTreeChartDom, 'dark');
                    treeChart.setOption({
                        title: {
                            text: '操作提示：单击展开分类，双击进入具体分类页面',
                            textStyle: {
                                fontSize: 12,
                                color: '#999',
                                fontWeight: 'normal'
                            },
                            bottom: 0,
                            left: 'center'
                        },
                        tooltip: {
                            trigger: 'item',
                            triggerOn: 'mousemove'
                        },
                        series: [{
                            type: 'tree',
                            data: [{"name":"Categories","children":[{"name":"uboot","children":[{"name":"other","children":[],"count":12,"path":"uboot/other"},{"name":"子目录","children":[],"count":10,"path":"uboot/子目录"},{"name":"u-boot分类","children":[{"name":"api","children":[],"count":1,"path":"uboot/u-boot分类/api"},{"name":"arch","children":[{"name":"arm","children":[],"count":2,"path":"uboot/u-boot分类/arch/arm"}],"count":3,"path":"uboot/u-boot分类/arch"},{"name":"boot","children":[],"count":4,"path":"uboot/u-boot分类/boot"},{"name":"common","children":[],"count":10,"path":"uboot/u-boot分类/common"},{"name":"cmd","children":[],"count":1,"path":"uboot/u-boot分类/cmd"},{"name":"dm","children":[],"count":15,"path":"uboot/u-boot分类/dm"},{"name":"env","children":[],"count":1,"path":"uboot/u-boot分类/env"},{"name":"fdt","children":[],"count":1,"path":"uboot/u-boot分类/fdt"},{"name":"lib","children":[],"count":4,"path":"uboot/u-boot分类/lib"},{"name":"include","children":[],"count":3,"path":"uboot/u-boot分类/include"},{"name":"test","children":[],"count":1,"path":"uboot/u-boot分类/test"}],"count":44,"path":"uboot/u-boot分类"}],"count":68,"path":"uboot"},{"name":"rt-thread","children":[{"name":"其他资料","children":[{"name":"fatfs","children":[],"count":1,"path":"rt-thread/其他资料/fatfs"}],"count":1,"path":"rt-thread/其他资料"}],"count":44,"path":"rt-thread"},{"name":"linux","children":[{"name":"fs","children":[],"count":37,"path":"linux/fs"},{"name":"lib","children":[],"count":19,"path":"linux/lib"},{"name":"mm","children":[],"count":19,"path":"linux/mm"},{"name":"kernel","children":[{"name":"time","children":[],"count":10,"path":"linux/kernel/time"},{"name":"irq","children":[],"count":5,"path":"linux/kernel/irq"},{"name":"rcu","children":[],"count":3,"path":"linux/kernel/rcu"},{"name":"lock","children":[],"count":7,"path":"linux/kernel/lock"},{"name":"sched","children":[],"count":7,"path":"linux/kernel/sched"}],"count":61,"path":"linux/kernel"},{"name":"other","children":[],"count":17,"path":"linux/other"},{"name":"scripts","children":[],"count":2,"path":"linux/scripts"},{"name":"security","children":[],"count":1,"path":"linux/security"},{"name":"include","children":[],"count":10,"path":"linux/include"},{"name":"block","children":[],"count":5,"path":"linux/block"},{"name":"drivers","children":[{"name":"clk","children":[],"count":2,"path":"linux/drivers/clk"},{"name":"base","children":[],"count":14,"path":"linux/drivers/base"},{"name":"tty","children":[],"count":2,"path":"linux/drivers/tty"}],"count":39,"path":"linux/drivers"},{"name":"arch","children":[{"name":"arm","children":[],"count":10,"path":"linux/arch/arm"}],"count":10,"path":"linux/arch"}],"count":227,"path":"linux"},{"name":"hpatch","children":[{"name":"SA-IS","children":[],"count":1,"path":"hpatch/SA-IS"},{"name":"libdivsufsort","children":[],"count":3,"path":"hpatch/libdivsufsort"}],"count":10,"path":"hpatch"},{"name":"杂谈","children":[],"count":8,"path":"杂谈"},{"name":"MCU","children":[],"count":23,"path":"MCU"},{"name":"git","children":[],"count":6,"path":"git"},{"name":"LoraWan","children":[{"name":"LoRaWAN标准","children":[{"name":"LoRaWAN-Specification_ZH_CN","children":[{"name":"LoRaWAN-Specification_ZH_CN-190102","children":[{"name":"chapter","children":[],"count":20,"path":"LoraWan/LoRaWAN标准/LoRaWAN-Specification_ZH_CN/LoRaWAN-Specification_ZH_CN-190102/chapter"}],"count":22,"path":"LoraWan/LoRaWAN标准/LoRaWAN-Specification_ZH_CN/LoRaWAN-Specification_ZH_CN-190102"}],"count":22,"path":"LoraWan/LoRaWAN标准/LoRaWAN-Specification_ZH_CN"}],"count":22,"path":"LoraWan/LoRaWAN标准"}],"count":23,"path":"LoraWan"},{"name":"freertos","children":[],"count":1,"path":"freertos"},{"name":"tmc5160","children":[],"count":1,"path":"tmc5160"}],"count":0,"path":""}],
                            initialTreeDepth: -1,
                            top: '5%',
                            bottom: '10%',
                            left: '0%',
                            right: '0%',
                            symbolSize: 15,
                            layout: 'orthogonal',
                            orient: 'TB',
                            itemStyle: {
                                color: '#91CC75',
                                borderColor: '#73C0DE'
                            },
                            label: {
                                position: 'bottom',
                                verticalAlign: 'middle',
                                align: 'center',
                                fontSize: 14,
                                distance: 28,
                                formatter: function(params) {
                                    return params.data.name + (params.data.count ? ' (' + params.data.count + ')' : '');
                                }
                            },
                            leaves: {
                                label: {
                                    position: 'top',
                                    verticalAlign: 'middle',
                                    align: 'center'
                                }
                            },
                            emphasis: {
                                focus: 'descendant'
                            },
                            expandAndCollapse: true
                        }]
                    });

                    treeChart.on('dblclick', function (params) {
                        if (params.data && params.data.path) {
                            window.location.href = '/categories/' + params.data.path;
                        }
                    });
                }
            });
        </script>
    
    <script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"react":{"opacity":0.7},"log":false});</script></body></html>